{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "Patriot MXDR SOC Performance",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "sentinel",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "/subscriptions/32e993b8-ebcd-4bca-98e7-23b6d3639b38/resourcegroups/kahs-security/providers/microsoft.operationalinsights/workspaces/kahs-sentinel",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2022-04-01",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"<div style=\\\"text-align: center;\\\">\\r\\n    <img src=\\\"https://patriotconsultingtech.com/upload/domain/14813/images/Patriot/Home/LogoPatriot.png?393685.7799999998\\\" alt=\\\"Company Logo\\\" width=\\\"200\\\">\\r\\n</div>\"},\"name\":\"text - 7\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2\",\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6\",\"/subscriptions/0d93be1e-b290-4df1-a08a-1488d55163b2\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84\",\"/subscriptions/220f9ca3-d7a1-4dee-a2e3-d4509466fe14\",\"/subscriptions/2814c0d9-23d6-40d9-8ed5-6fffbbd6680d\",\"/subscriptions/2fbe3cb0-f1f1-43d7-b285-6584a63c445f\",\"/subscriptions/39f5c4fa-17b3-4810-b2ae-a87212959144\",\"/subscriptions/3faa5696-3027-477c-af64-310382d8896a\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711\",\"/subscriptions/528eda1e-0016-4222-93cf-7ede98fe5a1e\",\"/subscriptions/5439aee6-5953-43c8-9a93-5d3d5c218623\",\"/subscriptions/4bfcd005-ddbc-47b8-b9c3-bb08ca6023a5\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4\",\"/subscriptions/55b7b29c-837c-444f-a670-2eaabf6736be\",\"/subscriptions/59512c06-90f1-41c8-a07d-039a2dbfc4af\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72\",\"/subscriptions/60ae53dd-2eb5-4ec6-ac2b-96129714c619\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc\",\"/subscriptions/8317336e-66d6-4133-a34c-7a0091b67678\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae\",\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8\",\"/subscriptions/b309dd69-2f6b-49d0-9ac8-ac5ad66a6e9f\",\"/subscriptions/b66c289f-7034-4e4d-a7b3-8aa52313e314\",\"/subscriptions/bbe059b8-8f9a-45fc-a48f-34d8447eef3e\",\"/subscriptions/d99e5b2e-cd8b-461a-adb0-193cc71c572e\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4\",\"/subscriptions/ecf988cd-a260-40b7-b4c1-6c4104ab5fd5\",\"/subscriptions/f0193ba4-262a-4e36-bb3b-eaf9b8f86b45\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839\",\"/subscriptions/fc0013ed-646b-434a-adf9-6613c8516183\",\"/subscriptions/2b83e0fd-a2da-494a-8acf-f24b55e9905c\",\"/subscriptions/4c6d71cd-e071-4cd2-980c-4df20d57b1c3\",\"/subscriptions/723b9d60-f212-4846-b020-9c1ba74a929b\"],\"parameters\":[{\"id\":\"4dc24911-027f-4551-b63d-e2129f7bad23\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Workspace\",\"label\":\"Select Workspace\",\"type\":5,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"resources\\r\\n| where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| extend customerID = trim(' ', tostring(properties.customerId))\\r\\n| project id, customerID, name=tolower(name)\\r\\n|join \\r\\n(\\r\\n\\tresources\\r\\n\\t// Just show Workspaces that have Sentinel enabled\\r\\n\\t| where type =~ \\\"microsoft.operationsmanagement/solutions\\\"\\r\\n\\t| where name has \\\"SecurityInsights\\\"\\r\\n\\t| parse name with * '(' s_workspace ')'*\\r\\n\\t| project name=tolower(s_workspace)\\r\\n) on name\\r\\n| project tolower(id), customerID, name\",\"crossComponentResources\":[\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2\",\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6\",\"/subscriptions/0d93be1e-b290-4df1-a08a-1488d55163b2\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84\",\"/subscriptions/220f9ca3-d7a1-4dee-a2e3-d4509466fe14\",\"/subscriptions/2814c0d9-23d6-40d9-8ed5-6fffbbd6680d\",\"/subscriptions/2fbe3cb0-f1f1-43d7-b285-6584a63c445f\",\"/subscriptions/39f5c4fa-17b3-4810-b2ae-a87212959144\",\"/subscriptions/3faa5696-3027-477c-af64-310382d8896a\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711\",\"/subscriptions/528eda1e-0016-4222-93cf-7ede98fe5a1e\",\"/subscriptions/5439aee6-5953-43c8-9a93-5d3d5c218623\",\"/subscriptions/4bfcd005-ddbc-47b8-b9c3-bb08ca6023a5\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4\",\"/subscriptions/55b7b29c-837c-444f-a670-2eaabf6736be\",\"/subscriptions/59512c06-90f1-41c8-a07d-039a2dbfc4af\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72\",\"/subscriptions/60ae53dd-2eb5-4ec6-ac2b-96129714c619\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc\",\"/subscriptions/8317336e-66d6-4133-a34c-7a0091b67678\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae\",\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8\",\"/subscriptions/b309dd69-2f6b-49d0-9ac8-ac5ad66a6e9f\",\"/subscriptions/b66c289f-7034-4e4d-a7b3-8aa52313e314\",\"/subscriptions/bbe059b8-8f9a-45fc-a48f-34d8447eef3e\",\"/subscriptions/d99e5b2e-cd8b-461a-adb0-193cc71c572e\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4\",\"/subscriptions/ecf988cd-a260-40b7-b4c1-6c4104ab5fd5\",\"/subscriptions/f0193ba4-262a-4e36-bb3b-eaf9b8f86b45\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839\",\"/subscriptions/fc0013ed-646b-434a-adf9-6613c8516183\",\"/subscriptions/2b83e0fd-a2da-494a-8acf-f24b55e9905c\",\"/subscriptions/4c6d71cd-e071-4cd2-980c-4df20d57b1c3\",\"/subscriptions/723b9d60-f212-4846-b020-9c1ba74a929b\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::100\",\"value::all\"],\"showDefault\":false},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"7d597ad7-4a2a-45ed-a4fe-7ee32de0fc22\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time\",\"label\":\"Date\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":604800000},{\"durationMs\":2592000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContextFromParameter\":\"TimeRange\",\"value\":{\"durationMs\":604800000}},{\"id\":\"9a199167-2dde-49dd-8f01-23e9d1fa8151\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"InternalWSs\",\"type\":1,\"isRequired\":true,\"query\":\"SecurityIncident\\r\\n| take 1\\r\\n| parse IncidentUrl with * \\\"/workspaces/\\\" Workspace \\\"/\\\" *\\r\\n| project Workspace\",\"isHiddenWhenLocked\":true,\"timeContext\":{\"durationMs\":604800000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},{\"id\":\"7806fefd-432f-4828-9756-8c0be5c08d07\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"InternalSub\",\"type\":1,\"isRequired\":true,\"query\":\"where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| take 1\\r\\n| project subscriptionId\",\"crossComponentResources\":[\"value::selected\"],\"isHiddenWhenLocked\":true,\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"55d3ab63-6e1f-4d02-8d9e-2225526689c7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Subscription\",\"type\":6,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"Resources\\r\\n| summarize Count = count() by subscriptionId\\r\\n| order by Count desc\\r\\n| extend Rank = row_number()\\r\\n| project value = subscriptionId, label = subscriptionId, selected = Rank == 1\",\"crossComponentResources\":[\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84\",\"/subscriptions/3faa5696-3027-477c-af64-310382d8896a\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4\",\"/subscriptions/4bfcd005-ddbc-47b8-b9c3-bb08ca6023a5\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72\",\"/subscriptions/60ae53dd-2eb5-4ec6-ac2b-96129714c619\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc\",\"/subscriptions/8317336e-66d6-4133-a34c-7a0091b67678\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae\",\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2\",\"/subscriptions/b66c289f-7034-4e4d-a7b3-8aa52313e314\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839\",\"/subscriptions/fc0013ed-646b-434a-adf9-6613c8516183\",\"/subscriptions/0d93be1e-b290-4df1-a08a-1488d55163b2\",\"/subscriptions/220f9ca3-d7a1-4dee-a2e3-d4509466fe14\",\"/subscriptions/2814c0d9-23d6-40d9-8ed5-6fffbbd6680d\",\"/subscriptions/39f5c4fa-17b3-4810-b2ae-a87212959144\",\"/subscriptions/59512c06-90f1-41c8-a07d-039a2dbfc4af\",\"/subscriptions/b309dd69-2f6b-49d0-9ac8-ac5ad66a6e9f\",\"/subscriptions/bbe059b8-8f9a-45fc-a48f-34d8447eef3e\",\"/subscriptions/d99e5b2e-cd8b-461a-adb0-193cc71c572e\"],\"isHiddenWhenLocked\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"95a45501-31b5-4ea2-bcb3-eb208e0080e2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Work\",\"type\":5,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"//resources | where type =~ 'Microsoft.operationsmanagement/solutions' | where name contains //'SecurityInsights' | project id //= tostring(properties.workspaceResourceId)\\r\\n\\r\\nwhere type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| project value =id, label = name, selected = iff(name =~ '{InternalWSs}', true, false)\\r\\n\\r\\n\\r\\n\",\"crossComponentResources\":[\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2\",\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84\",\"/subscriptions/3faa5696-3027-477c-af64-310382d8896a\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae\",\"/subscriptions/b66c289f-7034-4e4d-a7b3-8aa52313e314\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839\",\"/subscriptions/fc0013ed-646b-434a-adf9-6613c8516183\",\"/subscriptions/4bfcd005-ddbc-47b8-b9c3-bb08ca6023a5\",\"/subscriptions/60ae53dd-2eb5-4ec6-ac2b-96129714c619\",\"/subscriptions/8317336e-66d6-4133-a34c-7a0091b67678\"],\"isHiddenWhenLocked\":true,\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"}],\"style\":\"above\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"customWidth\":\"100\",\"name\":\"parameters - 6\"},{\"type\":1,\"content\":{\"json\":\"\\n<h2>This workbook provides SOC performance metrics for the selected time range.</h2>\"},\"name\":\"text - 2\"},{\"type\":1,\"content\":{\"json\":\"<h1>Service Level Metrics</h1>\",\"style\":\"success\"},\"name\":\"text - 2\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"678a2c3e-1ec0-4ec6-bd85-d85b7b6d8abd\",\"cellValue\":\"Page\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Service Level\",\"subTarget\":\"SOC Performance Metrics\",\"style\":\"link\"},{\"id\":\"934756ad-e671-4a24-969c-156132c48741\",\"cellValue\":\"Page\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Incidents For Review\",\"subTarget\":\"EU\",\"style\":\"link\"}]},\"name\":\"links - 19\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, Title, Status, Severity, Owner, Labels, AdditionalData, Classification, ClassificationReason, TenantId) by IncidentNumber\\r\\n| where Labels has 'Escalated'\\r\\n| project IncidentNumber, Title, Severity, Owner.assignedTo, Status, Labels, Classification, TenantId\",\"size\":0,\"title\":\"Escalated Incidents\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"filter\":true}},\"customWidth\":\"100\",\"name\":\"query - 15\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n|where Owner has \\\"@mxdr365.com\\\" \\r\\n| summarize arg_max(TimeGenerated, Title, Status, Severity, Owner, Labels, AdditionalData, Classification, ClassificationReason, TenantId, FirstModifiedTime, CreatedTime) by IncidentNumber\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime\\r\\n| extend Hi_SLA_Voilation_Time = TotalTime - 60m\\r\\n| extend Med_SLA_Voilation_Time = TotalTime - 240m \\r\\n| extend Lo_SLA_Voilation_Time = TotalTime - 1440m\\r\\n| extend In_SLA_Voilation_Time = TotalTime - 1440m\\r\\n| extend HI = totimespan(Hi_SLA_Voilation_Time)\\r\\n| extend MED = totimespan(Med_SLA_Voilation_Time)\\r\\n| extend LOW = totimespan(Lo_SLA_Voilation_Time)\\r\\n| extend INFO = totimespan(In_SLA_Voilation_Time)\\r\\n| extend TS1 = HI / 1s\\r\\n| extend TS2 = MED / 1s\\r\\n| extend TS3 = LOW / 1s\\r\\n| extend TS3 = INFO / 1s\\r\\n| extend hi=TS1 < 3600\\r\\n| extend Med=TS2 < 18,000\\r\\n| extend lo=TS2 < 86400\\r\\n| extend info=TS2 < 86400\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where (Severity == \\\"High\\\" and hi == false) or (Severity == \\\"Medium\\\" and Med == false) or (Severity == \\\"Low\\\" and lo == false) or (Severity == \\\"Informational\\\" and info == false)\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| project IncidentNumber, Title, Severity, Owner.assignedTo, Status,Classification\",\"size\":0,\"title\":\"SLA Unmet\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\"},\"name\":\"query - 19\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Page\",\"comparison\":\"isEqualTo\",\"value\":\"EU\"},\"name\":\"group - 6\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| summarize dcount(IncidentNumber) by Severity\",\"size\":1,\"title\":\"All Incidents by Severity\",\"noDataMessageStyle\":4,\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"piechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"High\",\"color\":\"red\"},{\"seriesName\":\"Medium\",\"color\":\"orange\"},{\"seriesName\":\"Low\",\"color\":\"yellow\"},{\"seriesName\":\"Informational\",\"color\":\"gray\"}]}},\"customWidth\":\"40\",\"name\":\"query - 4\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData, CreatedTime, Classification, ClassificationReason) by IncidentNumber\\r\\n| where Status == 'Closed'\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| extend feedback =strcat(Classification,\\\" \\\",ClassificationReason)\\r\\n| summarize dcount(IncidentNumber) by feedback\\r\\n\\r\\n\",\"size\":1,\"title\":\"Incidents Closed by classification \",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"piechart\"},\"customWidth\":\"60\",\"name\":\"query - 7\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":1,\"content\":{\"json\":\"TTA By Severity\",\"style\":\"upsell\"},\"customWidth\":\"32\",\"name\":\"text - 18 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"TTR By Severity\",\"style\":\"info\"},\"customWidth\":\"32\",\"name\":\"text - 18 - Copy - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"Service Level\",\"style\":\"success\"},\"customWidth\":\"36\",\"name\":\"text - 18 - Copy - Copy - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| extend TTA= (FirstModifiedTime - CreatedTime)/1h\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"High\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| where isnotnull(TTA)\\r\\n| summarize percentile(TTA, 50) by Severity\",\"size\":4,\"title\":\"High\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTA_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"sortCriteriaField\":\"Severity\",\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 18\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| extend TTA= (FirstModifiedTime - CreatedTime)/1h\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Medium\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| where isnotnull(TTA)\\r\\n| summarize percentile(TTA, 50) by Severity\",\"size\":4,\"title\":\"Medium\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTA_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"sortCriteriaField\":\"Severity\",\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 18 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| extend TTA= (FirstModifiedTime - CreatedTime)/1h\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Low\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| where isnotnull(TTA)\\r\\n| summarize percentile(TTA, 50) by Severity\",\"size\":4,\"title\":\"Low\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTA_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"sortCriteriaField\":\"Severity\",\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 18 - Copy - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| extend TTA= (FirstModifiedTime - CreatedTime)/1h\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Informational\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| where isnotnull(TTA)\\r\\n| summarize percentile(TTA, 50) by Severity\",\"size\":4,\"title\":\"Informational\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTA_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"sortCriteriaField\":\"Severity\",\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 18 - Copy - Copy - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Status has 'closed'\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"High\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| extend TTR= (ClosedTime - CreatedTime)/1h\\r\\n| where isnotnull(TTR)\\r\\n| summarize percentile(TTR, 50) by Severity\",\"size\":4,\"title\":\"High\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTR_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 17\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Status has 'closed'\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Medium\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| extend TTR= (ClosedTime - CreatedTime)/1h\\r\\n| where isnotnull(TTR)\\r\\n| summarize percentile(TTR, 50) by Severity\",\"size\":4,\"title\":\"Medium\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTR_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 17 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Status has 'closed'\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Low\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| extend TTR= (ClosedTime - CreatedTime)/1h\\r\\n| where isnotnull(TTR)\\r\\n| summarize percentile(TTR, 50) by Severity\",\"size\":4,\"title\":\"Low\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTR_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 17 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Status has 'closed'\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Severity has \\\"Informational\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| extend TTR= (ClosedTime - CreatedTime)/1h\\r\\n| where isnotnull(TTR)\\r\\n| summarize percentile(TTR, 50) by Severity\",\"size\":4,\"title\":\"Informational\",\"noDataMessage\":\"N/A\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"percentile_TTR_50\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 17 - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} \\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| summarize count_distinct(IncidentNumber)\\r\\n\",\"size\":4,\"title\":\"Total Incidents\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_distinct_IncidentNumber\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}}},\"showBorder\":false,\"size\":\"auto\"}},\"customWidth\":\"8\",\"name\":\"query - 13\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let Medium = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime//- - ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 240m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 18,000\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Medium\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nlet Low = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 1440m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 86400\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Low\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nlet Informational = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 1440m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 86400\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Informational\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 60m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 3600\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"High\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber)\\r\\n| extend AllSevCount = todouble(ValCount) + todouble(Medium) + Low + Informational\",\"size\":4,\"title\":\"SLA Unmet\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"VoilationsPer\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"VoilationsPer\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"AllSevCount\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}}},\"showBorder\":false,\"size\":\"auto\"},\"graphSettings\":{\"type\":0}},\"customWidth\":\"10\",\"name\":\"query - 30 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let Total = toscalar(SecurityIncident\\r\\n| where Owner has \\\"@mxdr365.com\\\" \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nlet Medium = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 240m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 18,000\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Medium\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nlet Low = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 480m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 86400\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Low\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nlet Informational = toscalar(SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 1440m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 86400\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"Informational\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| extend TotalTime = FirstModifiedTime - CreatedTime //- ClosedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 60m \\r\\n//| where SLA_Voilation_Time < 0m\\r\\n| extend DU = totimespan(SLA_Voilation_Time)\\r\\n| extend TS = DU / 1s\\r\\n| extend Re=TS < 3600\\r\\n| where Re == false\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"High\\\"\\r\\n| where Labels !has \\\"suppressed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| where Owner has \\\"@mxdr365.com\\\"\\r\\n| summarize ValCount = count_distinct(IncidentNumber)\\r\\n| extend AllSevCount = todouble(ValCount) + todouble(Medium) + Low + Informational\\r\\n| extend Re = Total - AllSevCount\\r\\n//| extend \\r\\n| extend co = Re / Total *  100\\r\\n//| project met = co -100\\r\\n\",\"size\":4,\"title\":\"SLA Met %\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"VoilationsPer\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"VoilationsPer\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"co\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":false,\"size\":\"auto\"},\"graphSettings\":{\"type\":0}},\"customWidth\":\"10\",\"name\":\"query - 30\"},{\"type\":1,\"content\":{\"json\":\"Incidents By Date\",\"style\":\"success\"},\"customWidth\":\"100\",\"name\":\"text - 18\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner has \\\"mxdr365.com\\\"\\r\\n| extend Tags = extract_all('labelName\\\":\\\"(.*?)\\\"',tostring(Labels))\\r\\n| mvexpand Tags to typeof(string)\\r\\n//| where Tags !has \\\"Redirected\\\"\\r\\n| summarize Incidents=dcount(IncidentNumber) by Tags, bin(CreatedTime, 1d)\",\"size\":0,\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"barchart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"<empty>\",\"label\":\"Total incidents\",\"color\":\"green\"},{\"seriesName\":\"Redirected\",\"color\":\"blueDark\"},{\"seriesName\":\"Escalated \",\"label\":\"Incidents Escalated To Client\",\"color\":\"redDark\"},{\"seriesName\":\"Suppressed\",\"label\":\"Surpressed By Automation\",\"color\":\"yellow\"},{\"seriesName\":\" Escalated\",\"color\":\"red\"}]}},\"customWidth\":\"100\",\"name\":\"query - 7\",\"styleSettings\":{\"maxWidth\":\"100%\"}}]},\"conditionalVisibility\":{\"parameterName\":\"Page\",\"comparison\":\"isEqualTo\",\"value\":\"SOC Performance Metrics\"},\"name\":\"SOC Performance Metrics\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"<h2>Analyst Performance Metrics</h2>\\r\\n<p>This tab has performance metrics about individual analysts. Select an analyst to see how they have performed in this workspace..</p>\"},\"name\":\"text - 18\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8/resourcegroups/rg-mxdr-prod/providers/microsoft.operationalinsights/workspaces/loganalytics-patriot-prod-01\",\"/subscriptions/96e4534f-1815-4eaf-9420-4d612d2aaf3f/resourceGroups/sentinel-sml-westus2/providers/Microsoft.OperationalInsights/workspaces/sentinel-sml-westus2\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae/resourceGroups/rg-mxdr-ybc/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-YBC\",\"/subscriptions/6c76a5c9-62c0-4aa6-8024-0fbeba577284/resourceGroups/jwcssentinel/providers/Microsoft.OperationalInsights/workspaces/jwcybersecure\",\"/subscriptions/6c76a5c9-62c0-4aa6-8024-0fbeba577284/resourceGroups/JWCSSentinel/providers/Microsoft.OperationalInsights/workspaces/JWCSSentinel\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4/resourceGroups/workspace_for_analytics/providers/Microsoft.OperationalInsights/workspaces/LogWorkSpace\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c/resourceGroups/rg-mxdr-sirc-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-SIRC-01\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711/resourceGroups/rg-mxdr-nationaltrust-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-NATIONALTRUST-01\",\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2/resourceGroups/rg-mxdr-ihm-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-IHM-01\",\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8/resourceGroups/rg-mxdr-prod/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-Patriot-Prod-01\",\"/subscriptions/23ac1f6d-fe94-45ed-8fe1-74c4b71fc78b/resourceGroups/bdsmktg-rg/providers/Microsoft.OperationalInsights/workspaces/BDSOMS\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839/resourceGroups/RG-MXDR-CODE-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-CODE-01\",\"/subscriptions/1d57098f-e1a8-414c-a853-1dbeeb8b532e/resourceGroups/sentinelallinone/providers/Microsoft.OperationalInsights/workspaces/SentinelAllInOne\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72/resourceGroups/RG-MXDR-ENVOY/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-ENVOY\",\"/subscriptions/96680a82-9483-4189-9d24-9cc3fad4fcc3/resourceGroups/rg-customer-sentinel-testing-eus2-001/providers/Microsoft.OperationalInsights/workspaces/Customer-Environment-LAW-eu2-Testing\",\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6/resourceGroups/RG-MXDR-FFW/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-FFW\",\"/subscriptions/46ae4288-dc4e-4ede-a6f3-fef99229ea24/resourceGroups/rg-mxdr-customer2/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-CUSTOMER-01\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84/resourceGroups/rg-usw1-sentinel/providers/Microsoft.OperationalInsights/workspaces/Sentinel-HDCCO\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc/resourceGroups/rg-mxdr-jkcf-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-JKCF-01\",\"/subscriptions/fb804558-cf5d-4379-8983-387477bbf5d5/resourceGroups/RG-MXDR-YBC/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-YBC\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce/resourceGroups/rg-mxdr-ppf-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-PPF-01\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-87a7ec84-b705-476a-b49c-a8c57607f1a1-SCUS\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/venturemet-monitor-scus-laws\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/workspace-sql-scus-aa\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba/resourceGroups/RG-MXDR-BAF/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-Apps-BAF\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba/resourceGroups/rg-mxdr-baf/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-BAF\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr-am/providers/Microsoft.OperationalInsights/workspaces/XELLAgain-AM-Sentinel\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr-mk/providers/Microsoft.OperationalInsights/workspaces/Space-MXDR-MK\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr/providers/Microsoft.OperationalInsights/workspaces/XELLagain-LA-Sentinel\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/option2-mxdr-mk/providers/Microsoft.OperationalInsights/workspaces/MK-MXDR\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4/resourceGroups/rg-mxdr-atac-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-ATAC-01\"],\"parameters\":[{\"id\":\"b9394fad-2544-4b7e-8c9d-f1562c87ec31\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Owner\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"SecurityIncident\\r\\n| extend owner = tostring(Owner.assignedTo) \\r\\n| where owner contains \\\"Analyst\\\"\\r\\n| summarize Count=count(IncidentNumber) by Owner= case(owner==\\\"\\\", \\\"Unassigned\\\",owner)\\r\\n| project Value = Owner\",\"crossComponentResources\":[\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8/resourcegroups/rg-mxdr-prod/providers/microsoft.operationalinsights/workspaces/loganalytics-patriot-prod-01\",\"/subscriptions/96e4534f-1815-4eaf-9420-4d612d2aaf3f/resourceGroups/sentinel-sml-westus2/providers/Microsoft.OperationalInsights/workspaces/sentinel-sml-westus2\",\"/subscriptions/90ae47fa-0ba2-4e1c-88b0-688e30595dae/resourceGroups/rg-mxdr-ybc/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-YBC\",\"/subscriptions/6c76a5c9-62c0-4aa6-8024-0fbeba577284/resourceGroups/jwcssentinel/providers/Microsoft.OperationalInsights/workspaces/jwcybersecure\",\"/subscriptions/6c76a5c9-62c0-4aa6-8024-0fbeba577284/resourceGroups/JWCSSentinel/providers/Microsoft.OperationalInsights/workspaces/JWCSSentinel\",\"/subscriptions/e945e691-d515-4a36-ac1a-c50c29582fd4/resourceGroups/workspace_for_analytics/providers/Microsoft.OperationalInsights/workspaces/LogWorkSpace\",\"/subscriptions/8a8042f4-da57-4b08-9883-a879ad215b4c/resourceGroups/rg-mxdr-sirc-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-SIRC-01\",\"/subscriptions/475ce72e-0d1a-4118-9f28-a0abdb6d3711/resourceGroups/rg-mxdr-nationaltrust-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-NATIONALTRUST-01\",\"/subscriptions/0381bfcf-0044-44be-9d42-0e2d4f2ffbb2/resourceGroups/rg-mxdr-ihm-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-IHM-01\",\"/subscriptions/96ab87fb-fd3a-4fcf-aa8e-a87cb20bdde8/resourceGroups/rg-mxdr-prod/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-Patriot-Prod-01\",\"/subscriptions/23ac1f6d-fe94-45ed-8fe1-74c4b71fc78b/resourceGroups/bdsmktg-rg/providers/Microsoft.OperationalInsights/workspaces/BDSOMS\",\"/subscriptions/f7d4bfc8-3f9e-4677-badc-792181623839/resourceGroups/RG-MXDR-CODE-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-CODE-01\",\"/subscriptions/1d57098f-e1a8-414c-a853-1dbeeb8b532e/resourceGroups/sentinelallinone/providers/Microsoft.OperationalInsights/workspaces/SentinelAllInOne\",\"/subscriptions/5ec49d41-5d28-487f-926f-a63d5e32da72/resourceGroups/RG-MXDR-ENVOY/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-ENVOY\",\"/subscriptions/96680a82-9483-4189-9d24-9cc3fad4fcc3/resourceGroups/rg-customer-sentinel-testing-eus2-001/providers/Microsoft.OperationalInsights/workspaces/Customer-Environment-LAW-eu2-Testing\",\"/subscriptions/0d6aa6ad-0f3c-46e7-938f-e4e2457791f6/resourceGroups/RG-MXDR-FFW/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-FFW\",\"/subscriptions/46ae4288-dc4e-4ede-a6f3-fef99229ea24/resourceGroups/rg-mxdr-customer2/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-CUSTOMER-01\",\"/subscriptions/1be1af96-32cc-4c1c-8d3f-fbd68fcb5b84/resourceGroups/rg-usw1-sentinel/providers/Microsoft.OperationalInsights/workspaces/Sentinel-HDCCO\",\"/subscriptions/803befd8-b151-4a21-b062-5a1aa9d61fbc/resourceGroups/rg-mxdr-jkcf-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-JKCF-01\",\"/subscriptions/fb804558-cf5d-4379-8983-387477bbf5d5/resourceGroups/RG-MXDR-YBC/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-YBC\",\"/subscriptions/f445a241-24a0-4fca-a67f-91d7839d1cce/resourceGroups/rg-mxdr-ppf-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-PPF-01\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-87a7ec84-b705-476a-b49c-a8c57607f1a1-SCUS\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/venturemet-monitor-scus-laws\",\"/subscriptions/87a7ec84-b705-476a-b49c-a8c57607f1a1/resourceGroups/venturemet-monitor-scus-rg/providers/Microsoft.OperationalInsights/workspaces/workspace-sql-scus-aa\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba/resourceGroups/RG-MXDR-BAF/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-Apps-BAF\",\"/subscriptions/7292c582-da74-4a01-8344-99582c4979ba/resourceGroups/rg-mxdr-baf/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-BAF\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr-am/providers/Microsoft.OperationalInsights/workspaces/XELLAgain-AM-Sentinel\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr-mk/providers/Microsoft.OperationalInsights/workspaces/Space-MXDR-MK\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/mxdr/providers/Microsoft.OperationalInsights/workspaces/XELLagain-LA-Sentinel\",\"/subscriptions/7bb04fb1-3433-472e-90ce-eed123b2f7a0/resourceGroups/option2-mxdr-mk/providers/Microsoft.OperationalInsights/workspaces/MK-MXDR\",\"/subscriptions/49266260-f208-4ba1-ae3d-e632fe7f66c4/resourceGroups/rg-mxdr-atac-01/providers/Microsoft.OperationalInsights/workspaces/LogAnalytics-MXDR-ATAC-01\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":604800000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"analyst8\"]}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 21\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize count() by case(tostring(Severity)==\\\"\\\", \\\"No Severity\\\",tostring(Severity))\",\"size\":1,\"title\":\"All Incident Generated by Severity (Analyst)\",\"noDataMessageStyle\":4,\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"piechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"High\",\"color\":\"red\"},{\"seriesName\":\"Medium\",\"color\":\"orange\"},{\"seriesName\":\"Low\",\"color\":\"yellow\"},{\"seriesName\":\"Informational\",\"color\":\"gray\"}]}},\"customWidth\":\"40\",\"name\":\"query - 4 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[]},\"name\":\"group - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| summarize dcount(IncidentNumber) by Status\",\"size\":1,\"title\":\"All Incidents By Status (Analyst)\",\"noDataMessageStyle\":3,\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Status\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"dcount_IncidentNumber\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"size\":\"auto\"}},\"customWidth\":\"20\",\"name\":\"query - 5 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| where Status has \\\"Closed\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"Closed Incidents By % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":1,\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true}},\"customWidth\":\"13\",\"name\":\"query - 8 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| where Status has \\\"New\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"New Incidents in Queue by % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":1,\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true}},\"customWidth\":\"14\",\"name\":\"query - 9 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\\r\\n| where Status has \\\"Active\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"Active Incidents in Queue By % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Percentage\",\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true}},\"customWidth\":\"13\",\"name\":\"query - 10 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData, CreatedTime, Classification, ClassificationReason) by IncidentNumber\\r\\n| where Status == 'Closed'\\r\\n| extend feedback =strcat(Classification,\\\" \\\",ClassificationReason)\\r\\n| summarize dcount(IncidentNumber) by feedback\\r\\n\\r\\n\",\"size\":1,\"title\":\"Incidents Closed by classification (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"piechart\"},\"customWidth\":\"50\",\"name\":\"query - 7 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData, Classification) by IncidentNumber\\r\\n| where Status has \\\"Closed\\\"\\r\\n| where Classification has \\\"Undetermined\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"Undetermined Classification % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Status\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"customWidth\":\"12\",\"name\":\"query - 11 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData, Classification) by IncidentNumber\\r\\n| where Status has \\\"Closed\\\"\\r\\n| where Classification has \\\"BenignPositive\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"BenignPositive Classification % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\",\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}},\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true,\"size\":\"auto\"}},\"customWidth\":\"12\",\"name\":\"query - 12 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData, Classification) by IncidentNumber\\r\\n| where Status has \\\"Closed\\\"\\r\\n| where Classification has \\\"TruePositive\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"True Positive Classification % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true}},\"customWidth\":\"12\",\"name\":\"query - 13 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TotalStorms = toscalar(SecurityIncident | where CreatedTime >= {Time:start} and CreatedTime <= {Time:end} | summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber | summarize count_distinct(IncidentNumber));\\r\\nSecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData, Classification) by IncidentNumber\\r\\n| where Status has \\\"Closed\\\"\\r\\n| where Classification has \\\"FalsePositive\\\"\\r\\n| summarize EventCount = count_distinct(IncidentNumber)\\r\\n| project Percentage = todouble(EventCount) / TotalStorms * 100.0\",\"size\":1,\"title\":\"False Positive Classification % (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Percentage\",\"formatter\":12,\"formatOptions\":{\"palette\":\"blue\"},\"numberFormat\":{\"unit\":1,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}},\"showBorder\":true}},\"customWidth\":\"13\",\"name\":\"query - 14 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| extend Tags = extract_all('labelName\\\":\\\"(.*?)\\\"',tostring(Labels))\\r\\n| mvexpand Tags to typeof(string)\\r\\n| summarize Incidents=dcount(IncidentNumber) by Tags, bin(CreatedTime, 1d)\",\"size\":0,\"title\":\"Incidents By Tags (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"barchart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"<empty>\",\"label\":\"Total incidents\",\"color\":\"green\"},{\"seriesName\":\"Redirected\",\"color\":\"blueDark\"},{\"seriesName\":\"Escalated \",\"label\":\"Incidents Escalated To Client\",\"color\":\"redDark\"},{\"seriesName\":\"Suppressed\",\"label\":\"Surpressed By Automation\",\"color\":\"yellow\"},{\"seriesName\":\" Escalated\",\"color\":\"red\"}]}},\"customWidth\":\"50\",\"name\":\"query - 7 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated, Title, Status, Severity, Owner, Labels, AdditionalData, Classification, ClassificationReason, TenantId) by IncidentNumber\\r\\n| where Labels has 'Escalated'\\r\\n| project IncidentNumber, Title, Severity, Owner.assignedTo, Status, Labels, Classification, TenantId\",\"size\":0,\"title\":\"Escalated Incidents List by Analyst\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"filter\":true}},\"customWidth\":\"50\",\"name\":\"query - 15 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime >= {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, CreatedTime, AdditionalData, Classification, ClassificationReason, Title) by IncidentNumber\\r\\n| summarize count() by bin(CreatedTime, 1h), Title\\r\\n| order by count_ desc\",\"size\":1,\"title\":\"Incidents Created by Name (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"piechart\"},\"customWidth\":\"50\",\"name\":\"query - 15 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| extend TTA= (FirstModifiedTime - CreatedTime)/1h\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where isnotnull(TTA)\\r\\n| summarize avg(TTA) by Severity\",\"size\":1,\"title\":\"Incidents TTA by Severity (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Severity\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"avg_TTA\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"customWidth\":\"25\",\"name\":\"query - 18 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| where CreatedTime > {Time:start} and CreatedTime <= {Time:end}\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Status has 'closed'\\r\\n| where Labels !has 'Suppressed'\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| extend TTR= (LastModifiedTime - CreatedTime)/1h\\r\\n| where isnotnull(TTR)\\r\\n| summarize avg(TTR) by Severity\",\"size\":1,\"title\":\"Incidents TTR by Severity (Analyst)\",\"timeContextFromParameter\":\"Time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Severity\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"avg_TTR\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":26,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"customWidth\":\"25\",\"name\":\"query - 17 - Copy\",\"styleSettings\":{\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident \\r\\n| extend TotalTime = LastModifiedTime - CreatedTime \\r\\n| extend SLA_Voilation_Time = TotalTime - 60m \\r\\n| where SLA_Voilation_Time > 0m\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| where Severity == \\\"High\\\"\\r\\n| where Owner.assignedTo has_any({Owner})\\r\\n| where Labels !has \\\"Supperessed\\\"\\r\\n| where Labels !has \\\"Escalated\\\"\\r\\n| where Labels !has \\\" Escalated\\\"\\r\\n| where Labels !has \\\"Redirected\\\"\\r\\n| project IncidentNumber, CreatedTime, FirstModifiedTime, LastModifiedTime, SLA_Voilation_Time, Title, Status, Severity, Owner.assignedTo\",\"size\":0,\"title\":\"SLA Violated High Severity Incidents by Analyst\",\"timeContextFromParameter\":\"Time\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"IncidentNumber\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30%\"}},{\"columnMatch\":\"CreatedTime\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30%\"}},{\"columnMatch\":\"FirstModifiedTime\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30%\"}},{\"columnMatch\":\"LastModifiedTime\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30%\"}},{\"columnMatch\":\"VoilationTime\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30%\"}}],\"sortBy\":[{\"itemKey\":\"CreatedTime\",\"sortOrder\":2}]},\"sortBy\":[{\"itemKey\":\"CreatedTime\",\"sortOrder\":2}]},\"customWidth\":\"100\",\"name\":\"query - 18 - Copy\",\"styleSettings\":{\"margin\":\"0px\",\"padding\":\"0px\",\"maxWidth\":\"100%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Page\",\"comparison\":\"isEqualTo\",\"value\":\"Analyst Performance Metrics\"},\"name\":\"Analyst Performance Metrics\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"/subscriptions/32e993b8-ebcd-4bca-98e7-23b6d3639b38/resourcegroups/kahs-security/providers/microsoft.operationalinsights/workspaces/kahs-sentinel\"],\"fromTemplateId\":\"sentinel-UserWorkbook\"}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}
